---
title: 保证消息消费的幂等性
date: '2021-03-17 22:22:13'
categories:
    - mq
tags:
    - mq
---

## 保证消息队列消费的幂等性

幂等性，通俗点说，就一个数据，或者一个请求，给你重复来多次，确保对应的数据是不会改变的，不能出错。

结合业务来思考：

- 写库，你先根据主键查一下，存在 update、数据库的唯一键等
- Redis，每次都是 set，天然幂等性
- 生产者发送每条数据的时候，里面加一个全局唯一的 id，消费时，先根据 id 查询
